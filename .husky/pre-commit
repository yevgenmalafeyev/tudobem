#!/bin/sh

# Exit on any error
set -e

echo "ğŸ” Running pre-commit checks..."

# Check if we're in the right directory
if [ ! -f "package.json" ]; then
    echo "âŒ Error: package.json not found. Are you in the project root?"
    exit 1
fi

echo "ğŸ“ Checking TypeScript types..."

# Run TypeScript compiler in check mode (no emit), using build config that excludes test files
npx tsc --noEmit -p tsconfig.build.json

if [ $? -eq 0 ]; then
    echo "âœ… TypeScript check passed!"
else
    echo "âŒ TypeScript errors found! Please fix them before committing."
    echo "ğŸ’¡ Tip: Run 'npx tsc --noEmit' to see the errors."
    exit 1
fi

echo "ğŸ¨ Running ESLint..."

# Run ESLint
npm run lint

if [ $? -eq 0 ]; then
    echo "âœ… ESLint check passed!"
else
    echo "âŒ ESLint errors found! Please fix them before committing."
    exit 1
fi

echo "âœ¨ Pre-commit checks passed!"